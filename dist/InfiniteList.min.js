!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.InfiniteList=t():e.InfiniteList=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){var r=n(2),i=n(3);ScrollbarRenderer=n(5),AnimationFrameHelper=n(6),ListItemsRenderer=n(7),StyleHelpers=n(4),DEFAULT_ITEM_HEIGHT=2,RESIZE_CHECK_INTERVAL=500;var o=function(e){function t(e,t){return h=e,f(e),E=new ListItemsRenderer(e,v,d,u),d.useNativeScroller?x=new i(I,function(e){S=e||0,O=!0}):(y=new ScrollbarRenderer(I),x=new r(h,function(e){S=e||0,O=!0},t),x.setDimensions(Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER)),o(),m(),this}function n(){AnimationFrameHelper.stopAnimationLoop(),h.removeChild(I)}function o(){AnimationFrameHelper.startAnimationLoop(function(){O&&s()})}function a(e){for(var t=e||0;t<d.itemsCount;++t)H[t]=d.itemHeightGetter&&d.itemHeightGetter(t)||H[t]||200;d.hasMore&&(H[d.itemsCount]=200)}function f(e){v=document.createElement("div"),StyleHelpers.applyElementStyle(v,{position:d.useNativeScroller?"relative":"absolute",width:"100%"}),I=document.createElement("div"),StyleHelpers.applyElementStyle(I,{position:"relative",height:"100%",width:"100%",overflowY:d.useNativeScroller?"scroll":"hidden"}),I.appendChild(v),e.appendChild(I)}function m(e){var t=E.getRenderedItems()[0],n=t&&t.getItemIndex()||0,r=t&&t.getItemOffset()||0,i=S-r;e&&(e.itemsCount&&(d.itemsCount>e.itemsCount?(n=0,I.scrollTop=0,i=0):d.itemsCount<e.itemsCount,d.itemsCount=e.itemsCount,H=H.slice(0,e.itemsCount)),null!=e.hasMore&&(d.hasMore=e.hasMore)),p=h.clientHeight,E.refresh(),a(),y&&y.refresh(),e&&!d.useNativeScroller&&c(n,!1,i),O=!0}function l(){var e=d.itemsCount-1+(d.hasMore?1:0),t=E.getRenderedItems(),n=t[t.length-1],r=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER;if(t.length>0&&0==t[0].getItemIndex()&&(r=t[0].getItemOffset()),n&&n.getItemIndex()==e&&(i=n.getItemOffset()+n.getItemHeight()-p),d.useNativeScroller){var o=0;H.forEach(function(e){o+=e}),StyleHelpers.applyElementStyle(v,{height:o+"px"})}else x.setDimensions(r,i)}function s(){var e;l(),d.useNativeScroller||StyleHelpers.applyTransformStyle(v,"matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,"+-S+", 0, 1)"),O=E.render(S,T,n,M),e=E.getRenderedItems(),T=null,n=null,e.forEach(function(e){H[e.getItemIndex()]=e.getItemHeight()});var t=e[0];if(t){for(var n=t.getItemOffset(),r=0,i=0;i<t.getItemIndex();++i)r+=H[i];if(n!=r){var o=n-r;I.scrollTop-=o,e.forEach(function(e){e.setItemOffset(e.getItemOffset()-o)})}}for(var a=0,f=0,i=0;i<H.length;++i)"number"==typeof H[i]&&(a+=H[i],f++);a/=f,y&&y.render(a*e[0].getItemIndex()+S-e[0].getItemOffset(),a*d.itemsCount)}function u(){d.pageFetcher(d.itemsCount,function(e,t){d.hasMore=t,d.itemsCount+=e,d.useNativeScroller,a(d.itemsCount-e),x.scrollTo(E.getRenderedItems()[E.getRenderedItems().length-1].getItemOffset()-p),d.useNativeScroller})}function c(e,t,n){var r=0;if(d.itemHeightGetter)for(var i=0;i<e;++i)r+=d.itemHeightGetter(i);else T=e;C=n||0,x.scrollTo(r,d.itemHeightGetter&&t)}function g(e){var t=E.getRenderedItems(),n=t.filter(function(t){return t.getItemIndex()==e})[0];if(n){var r=d.itemHeightGetter&&d.itemHeightGetter(e);r||(r=n.getDomElement().clientHeight,H[e]=r),n.setItemHeight(r);var i=n.getItemIndex()-t[0].getItemIndex(),o=t[i+1];if(n.getItemOffset()<S)for(;o&&n;)n.setItemOffset(o.getItemOffset()-n.getItemHeight()),o=n,n=t[--i];else for(;o&&n;)o.setItemOffset(n.getItemOffset()+n.getItemHeight()),n=o,o=t[++i+1]}}var p,d={itemHeightGetter:null,recalculateItemHeights:!1,itemRenderer:null,itemTypeGetter:null,pageFetcher:null,loadMoreRenderer:function(e,t){t.innerHTML='<div style="margin-left:14px;height:50px">Loading...</div>'},hasMore:!1,useNativeScroller:!1,itemsCount:0},h=null,I=null,v=null,y=null,E=null,x=null,H=[],S=0,T=0,C=0,M=2,O=!0;for(key in e)e.hasOwnProperty(key)&&(d[key]=e[key]);var L=e.initialPage;return L&&(d.itemsCount=L.itemsCount||0,d.hasMore=L.hasMore||!1),{attach:t,detach:n,scrollToItem:c,refresh:m,refreshItemHeight:g}};e.exports=o},function(e,t){var n=525,r=function(e,t){function r(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientY:e.clientY}function i(e){x=e,t(e)}function o(){var e,t,r;if(v)if(e=Date.now()-g,t=v*Math.exp(-e/n),r=H-t,r<p){if(H-t>=p-2)return void i(p);a(!0)}else if(r>d){if(H-t<=d+2)return void i(d);a(!1)}else t>2||t<-2?(i(H-t),requestAnimationFrame(o)):i(H)}function a(e){var t=e?p:d,r=e&&v>0||!e&&v<0;if(0!=v){var o=Date.now()-g,f=v*Math.exp(-o/(H==t?125:n));if(r&&Math.abs(f)<2)return void i(e?p:d);i(H-f),r?H!=t&&(H=t,v=H-x,g=new Date):(H=t-.1*(t-H),v=H-x),requestAnimationFrame(function(){a(e)})}}function f(e){y=!0,E=r(e),I=v=0,h=x,g=Date.now(),l(e),e.stopPropagation()}function m(e){var t,n,o=x<p||x>d?.5:1;y&&(l(e),t=r(e),n=E-t,(n>2||n<-2)&&(E=t,i(x+n*o))),e.preventDefault(),e.stopPropagation()}function l(e){var t=e.touches||[{pageX:e.pageX,pageY:e.pageY}],n=e.timeStamp,r=t[0].pageY;2===t.length&&(r=Math.abs(t[0].pageY+t[1].pageY)/2),S.push({offset:r,timestamp:n}),S.length>60&&S.splice(0,30)}function s(e){y=!1;for(var t=S.length-1,n=t-1,r=t-1;r>0&&S[r].timestamp>S[t].timestamp-100;r-=1)n=r;var i=S[t].timestamp-S[n].timestamp,a=S[t].offset-S[n].offset,f=-1e3*a/(1+i);I=.8*f+.2*I,v=1*I,H=Math.round(x+v),g=Date.now(),requestAnimationFrame(o),e.stopPropagation()}function u(e,t){var n=4e3;t?(e-x>n?x=e-n:x-e>n&&(x=e+n),v=e-x,H=e,g=Date.now(),requestAnimationFrame(o)):(v=0,i(e))}function c(e,t){p=e,d=t}var g=0,p=0,d=0,h=0,I=0,v=0,y=0,E=0,x=0,H=0,S=[];return e.addEventListener("touchstart",f),e.addEventListener("touchmove",m),e.addEventListener("touchend",s),e.addEventListener("mousedown",f),e.addEventListener("mousemove",m),e.addEventListener("mouseup",s),{setDimensions:c,scrollTo:u}};e.exports=r},function(e,t,n){var r=n(4),i=function(e,t){return e.addEventListener("scroll",function(){t(e.scrollTop)}),{setDimensions:function(t,n){r.applyElementStyle(e,{height:n-t+"px"})},scrollTo:function(){t(e.scrollTop)}}};e.exports=i},function(e,t){var n=function(e,t){Object.keys(t).forEach(function(n){e.style[n]!=t[n]&&(e.style[n]=t[n])})},r=function(e,t){var r={};["webkit","Moz","O","ms"].forEach(function(e){r[e+"Transform"]=t}),n(e,r)};e.exports={applyElementStyle:n,applyTransformStyle:r}},function(e,t,n){var r=n(4),i=function(e){function t(t,n){var a=(e.parentElement,Math.max(10,Math.floor(o/n*o))),f=Math.floor(t/(n-o)*(o-a)),m=a+"px";r.applyElementStyle(i,{height:m}),r.applyTransformStyle(i,"matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,"+f+", 0, 1)")}function n(){o=e.parentElement.clientHeight}var i=document.createElement("div"),o=e.parentElement.clientHeight;return r.applyElementStyle(i,{position:"absolute",top:"0px",right:"0px",marginRight:"3px",opacity:.3,width:"5px",backgroundColor:"#333"}),e.appendChild(i),{render:t,refresh:n}};e.exports=i},function(e,t){function n(e){var t=(new Date).getTime(),n=0;a=!0;var r=function(){var i=(new Date).getTime();n++,i-t>200&&(o=Math.min(60,1e3*n/(i-t)),t=i,n=0),e(),a&&requestAnimationFrame(r)};requestAnimationFrame(r)}function r(){a=!1}function i(){return o}var o=60,a=!1;e.exports={startAnimationLoop:n,stopAnimationLoop:r,getFPS:i}},function(e,t,n){var r=n(8),i=n(9),o=(n(6),30),a=1e3/o,f=function(e,t,n,o){function f(e,t,r,i){var o=(new Date).getTime();if("number"==typeof t&&t>=0){for(t=Math.max(0,Math.min(t,n.itemsCount-1));I.length>0;)v.addLayer(I.pop());var u=s(t);u.setItemOffset(e-(r||0)),I.push(u)}for(;I.length>1&&I[0]&&I[0].getItemOffset()<e;)v.addLayer(I.shift());for(var c=I[0];c&&c.getItemIndex()>0&&c.getItemOffset()>e;)if(c=m(c),I[I.length-1].getItemOffset()>e+d&&v.addLayer(I.pop()),(new Date).getTime()-o>a)return!0;var g=I[I.length-1];if(g.getItemIndex()<n.itemsCount&&"$LoadMore"==g.getIdentifier()){if(g=I[I.length-1],v.addLayer(I.pop()),I.length<=0)return f(e,g.getItemIndex(),void 0,i);g=I[I.length-1]}for(;g&&g.getItemIndex()<n.itemsCount&&g.getItemOffset()+g.getItemHeight()<e+d;)if(g=l(g),I[0].getItemOffset()+I[0].getItemHeight()<e&&v.addLayer(I.shift()),(new Date).getTime()-o>a)return!0;for(var p=I[0],h=0;h<I.length;++h)if(I[h].getItemOffset()+I[h].getItemHeight()>=e+d){p=I[h];break}for(;g&&g.getItemIndex()>p.getItemIndex()+i;)v.addLayer(I.pop()),g=I[I.length-1];for(;g&&g.getItemIndex()<n.itemsCount-1&&g.getItemIndex()<p.getItemIndex()+i;)if(g=l(g),(new Date).getTime()-o>a)return!0;var y=I[0]&&I[0].getItemOffset();return I.forEach(function(e){e.getItemOffset()!=y&&e.setItemOffset(y),y+=e.getItemHeight()}),!1}function m(e){var t=s(e.getItemIndex()-1);return t&&(t.setItemOffset(e.getItemOffset()-t.getItemHeight()),I.unshift(t)),t}function l(e){var t=s(e.getItemIndex()+1);return t&&(t.setItemOffset(e.getItemOffset()+e.getItemHeight()),I.push(t)),t}function s(e){if(e==n.itemsCount)return n.hasMore?c():null;var t=n.itemTypeGetter?n.itemTypeGetter(e):"",r=u(e,t);return n.itemRenderer(e,r.getDomElement()),r}function u(e,i){var o=i||(n.itemTypeGetter?n.itemTypeGetter(e):""),a=v.borrowLayerWithIdentifier(o);null==a&&(a=new r(t));var f=!n.recalculateItemHeights&&n.itemHeightGetter&&n.itemHeightGetter(e);return a.attach(e,n.useNativeScroller?0:13,f,o),a}function c(){if(0==I.length||"$LoadMore"!=I[I.length-1].getIdentifier()){var e=u(n.itemsCount,"$LoadMore");return n.loadMoreRenderer(n.itemsCount,e.getDomElement()),o(),e}return I[I.length-1]}function g(){d=e.clientHeight,h=e.clientWidth,I.forEach(function(e){n.itemRenderer(e.getItemIndex(),e.getDomElement()),e.setItemHeight(0)})}function p(){return I}var d=e.clientHeight,h=e.clientWidth,I=[],v=new i;return{render:f,refresh:g,getRenderedItems:p}};e.exports=f},function(e,t,n){var r=n(4),i=function(e){function t(e,t,n,i){return p=e,r.applyElementStyle(u,{right:t+"px",width:"100%",height:n+"px",overflow:"hidden"}),d=n,c=i,this}function n(){return p}function i(){return u}function o(){return c}function a(){return g}function f(e){r.applyTransformStyle(u,"matrix3d(1,0,0,0,0,1,0,0,0,0,1,0,0,"+e+", 0, 1)"),g=e}function m(){return d||(d=i().clientHeight)}function l(e){d=e}function s(){var e=document.createElement("div");return r.applyElementStyle(e,{position:"absolute",top:0,left:0}),e}var u=null,c="",g=-1,p=-1,d=0;return u=s(),e.appendChild(u),{attach:t,getItemIndex:n,getDomElement:i,getItemOffset:a,setItemOffset:f,getItemHeight:m,setItemHeight:l,getIdentifier:o}};e.exports=i},function(e,t,n){var r=n(4),i=function(){function e(e,t){var i=e.getIdentifier();null==n[i]&&(n[i]=[]),n[i].push(e),e.setItemOffset(-1e4),r.applyElementStyle(e.getDomElement(),{display:"none"}),t&&r.applyElementStyle(e.getDomElement(),{display:"none"})}function t(e){if(null==n[e])return null;var t=n[e].pop();return null!=t&&r.applyElementStyle(t.getDomElement(),{display:"block"}),t}var n={};return{addLayer:e,borrowLayerWithIdentifier:t}};e.exports=i}])});